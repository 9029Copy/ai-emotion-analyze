# 商品评论的AI情感分析前端程序

> 作者：9029Copy
> 日期：20250721

---

## 一、项目概述
- 这是一个前端应用程序，通过调用后端FastAPI服务的HTTP接口实现情感分析功能。[其后端服务](https://github.com/9029Copy/ai-chat-backend)使用API密钥认证，通过调用上游AI模型提供语句情感分析能力。
- 该项目能读取同目录下的`input.xlsx`文件中A列的商品评论，逐次提交到后端处理后，将分析结果写入同目录下的`output.xlsx`文件，同时能够输出每次消耗的token量。

## 二、功能特点
- 批量处理商品评论情感分析
- 分析结果输出为Excel格式，包含原始评论、情感分类、标签提取与评分
- 调整输出Excel文件列宽，优化可读性
- 能够输出每次消耗的token量
- 能够自定义调用的AI模型

## 三、环境要求
- Python 3.7+
- 依赖库：pandas, openpyxl, httpx, argparse, jsonschema

## 四、安装步骤
1. 克隆项目到本地
2. 安装依赖
    ```bash
    pip install pandas openpyxl httpx jsonschema
    ```

## 五、配置说明
创建`config.json`文件，包含以下配置信息：
```json
{
    "scheme": "http",
    "host": "localhost",
    "port": 8000,
    "model": "THUDM/GLM-4-9B-0414"
}
```
参数可根据实际情况稍作调整。

## 六、使用方法
### 1、准备输入数据
在`input.xlsx`文件中，将待分析的商品评论放在A列，首行为“商品评论”，例如：

| 商品评论 |
| :---: |
| 这是一条商品评论 |
| 这是另一条商品评论 |

### 2、运行程序
```bash
python data_analyze.py -k <your_api_key>
```
将其中`<your_api_key>`替换为实际的密钥。

### 3、查看结果
结果最终保存在同目录下的output.xlsx中，包含三列：商品评论、情感分类、消耗token量，例如：

| 商品评论 | 情感分类 | 标签 | 评分 | 处理状态 | 消耗token量 |
| :---: | :---: | :---: | :---: | :---: | :---: |
| 这是一条商品评论 | 正面 | ['标签1', '标签2'] | 9 | 完成 | 100 |
| 这是另一条商品评论 | 负面 | ['标签3', '标签4'] | 4 | 完成 | 150 |

### 4、命令行参数说明
| 参数 | 全称 | 说明 | 必需 |
| :---: | :---: | :---: | :---: |
| -k | --key | 后端API服务的访问密钥 | 是 |
| -m | --model | 后端API服务调用的AI模型 | 否 |
| --host |  | 后端服务主机地址 | 否 |
| --port |  | 后端服务端口 | 否 |
| --scheme |  | 后端服务协议 | 否 |

**其中后四项若省略，则调用`config.json`中的值，若`config.json`中也未配置，则使用默认值。**

## 七、注意事项
- 确保后端服务已启动并正常运行。
- API密钥必须有效且具有访问权限。
- 输入文件格式为.xlsx，且评论数据位于A列。
- 处理大量数据时可能需要较长时间，请耐心等待。